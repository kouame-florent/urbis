<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
xmlns:h="http://xmlns.jcp.org/jsf/html"
xmlns:f="http://xmlns.jcp.org/jsf/core"
xmlns:p="http://primefaces.org/ui">
    
 <ui:composition template="/WEB-INF/templates/dialog-tpl.xhtml">
     
     <ui:define name="title">
         Saisie actes existants
     </ui:define>
    
    <ui:define name="content">
        
        <f:metadata>
            <f:viewParam name="id" value="#{saisieActeExistantBacking.registreID}" />
            <f:viewAction action="#{saisieActeExistantBacking.onload}" />
        </f:metadata>
        
        <h:form id="messageForm">
                <p:growl globalOnly="true" life="15000"/>        
        </h:form>
             
        <h:form id="contentForm">  
            
            <p:focus context="contentForm"/>
           
            <p:fieldset legend="Référence registre">
               <div class="ui-fluid p-formgrid p-grid">
                   <div class="p-field p-col">
                   <p:outputLabel for="localite" styleClass="p-d-block">Commune</p:outputLabel>
                   <p:inputText id="localite" value="#{saisieActeExistantBacking.registreDto.localite}"
                                disabled="true" required="true" styleClass="p-d-block"/>

                   </div>
                   <div class="p-field p-col">
                       <p:outputLabel for="centre" styleClass="p-d-block">Centre</p:outputLabel>
                       <p:inputText id="centre" value="#{saisieActeExistantBacking.registreDto.centre}"
                                    disabled="true"  required="true" styleClass="p-d-block"/>

                   </div>
                   <div class="p-field p-col">
                       <p:outputLabel for="annee" styleClass="p-d-block">Année</p:outputLabel>
                       <p:inputText id="annee" value="#{saisieActeExistantBacking.registreDto.annee}" required="true"
                                    disabled="true" styleClass="p-d-block"/>

                   </div>
                   <div class="p-field p-col">
                       <p:outputLabel for="numero" styleClass="p-d-block">Numéro</p:outputLabel>
                       <p:inputText id="numero" value="#{saisieActeExistantBacking.registreDto.numero}"  required="true" 
                                    disabled="true"   styleClass="p-d-block"/>

                   </div>

               </div>

           </p:fieldset>
            <p:spacer height="2" />
                <p:dataTable id="registre" widgetVar="acteNaissanceWidget" var="acte" 
                        value="#{saisieActeExistantBacking.lazySaisieActeExistantDataModel}"
                        selectionMode="single"
                        selection="#{saisieActeExistantBacking.selectedActe}" rowKey="#{acte.id}" paginator="true"
                        rows="25" paginatorPosition="bottom" size="small">
                    
                    <p:ajax event="rowSelect" listener="#{saisieActeExistantBacking.onRowSelect}" update="@form"/>
                    
                    <f:facet name="header">
                        Actes de naissance
                    </f:facet>
                
                
                <p:column headerText="Nom"  >
                    <h:outputText value="#{acte.enfantNom}"/>
                </p:column>
                <p:column headerText="Prénoms"  >
                    <h:outputText value="#{acte.enfantPrenoms}"/>
                </p:column>
                
                 <p:column headerText="Date naissance"  >
                    <h:outputText value="#{acte.enfantDateNaissance}"/>
                </p:column>
                
                <p:column headerText="Année registre" >
                    <h:outputText value="#{acte.registreAnnee}"/>
                </p:column>
                
                <p:column headerText="Numéro registre" >
                    <h:outputText value="#{acte.registreNumero}"/>
                </p:column>
                 
                <p:column headerText="Numéro acte" >
                    <h:outputText value="#{acte.numero}"/>
                </p:column>
              
               
                </p:dataTable>
            <p:spacer height="4"/>
            <p:outputPanel>
            <p:toolbar>
                <p:toolbarGroup>
                    <p:tag id="modeNouvelAjoutTag" value="Ajout nouvel acte" severity="success" 
                           rendered="#{saisieActeExistantBacking.viewMode == 'NEW'}"/>
                    <p:tag id='modeMiseJourTag' value="Mise à jour des actes" severity="danger"
                           rendered="#{saisieActeExistantBacking.viewMode == 'UPDATE'}"/>
                    <p:spacer width="5"/>
                    <p:commandButton id="nouvelAnregistrement" value="Passer en mode 'ajout un nouvel acte'" process="@form" 
                                     action="#{saisieActeExistantBacking.nouvelEngeristrement()}"
                                     update="@form messageForm"  icon="pi pi-file" 
                                     styleClass="ui-button-outlined" 
                                     rendered="#{saisieActeExistantBacking.viewMode == 'UPDATE'}"/>
                    
                </p:toolbarGroup>
                <p:toolbarGroup align="right">
                    
                </p:toolbarGroup>
            </p:toolbar>
            </p:outputPanel>
            <p:spacer height="2"/>
            
            
            <p:wizard id="acteWizard" widgetVar="wizardWgt" flowListener="#{saisieActeExistantBacking.onFlowProcess}"
                      nextLabel="suivant" backLabel="précédent">
                <p:tab id="declaration" title="Déclaration">
                    
                    <ui:include src="/WEB-INF/includes/saisie-actes-existants/mode-declaration.xhtml"/>
           
                    <p:spacer height="2" />
            
                    <p:outputPanel id="naissanceMultipleOutputPanel" >
                    <div class="ui-fluid p-formgrid p-grid">
                        <div class="p-field p-lg-4">
                            <p:fieldset>
                                  <p:outputLabel for="numeroActe" styleClass="p-d-block" style="color: #ffffff">Numéro acte</p:outputLabel>
                                  <p:inputText id="numeroActe" value="#{saisieActeExistantBacking.acteNaissanceDto.numero}" 
                                               required="true"/>
                            </p:fieldset>
                        </div>
                       
                    </div>
                   
                    <p:spacer width="2"/>
                    <p:fieldset>      
                        <p:outputLabel for="typeNaisance" styleClass="p-d-block">Type naissance</p:outputLabel>
                        <p:selectOneMenu id="typeNaisance" converter="omnifaces.SelectItemsConverter" required="true"
                                        value="#{saisieActeExistantBacking.acteNaissanceDto.typeNaissance}" styleClass="p-d-block">
                           <f:selectItem itemValue="#{null}" itemLabel="-- selectionnez un type --" />
                           <f:selectItems value="#{saisieActeExistantBacking.typesNaissance}" var="type" 
                                          itemLabel="#{type.libelle}"  
                                          itemValue="#{type.code}" />
                        </p:selectOneMenu>
                        <p:message for="typeNaisance"/>
                    </p:fieldset> 
                    <p:spacer width="2"/>
                    <ui:include src="/WEB-INF/includes/saisie-actes-existants/le-declare.xhtml"/>
                    </p:outputPanel>
                    
                    <p:spacer height="2" />
                    
                    <ui:include src="/WEB-INF/includes/saisie-actes-existants/filiation.xhtml"/>
                    
                    <p:fieldset >
                        <div class="ui-fluid p-formgrid p-grid">
                            <div class="p-field p-lg-4">
                                <p:outputLabel for="dateDeclaration" styleClass="p-d-block">Date déclaration</p:outputLabel>
                                <p:inputMask id="dateDeclaration" value="#{saisieActeExistantBacking.acteNaissanceDto.dateDeclaration}"
                                             mask="99/99/9999" required="true">

                                </p:inputMask>
                                <p:watermark  value="jj/MM/AAAA" for="dateDeclaration" />    
                            </div>
                            <div class="p-field p-lg-4">
                                <p:outputLabel for="dateDressage" styleClass="p-d-block">Date dressage</p:outputLabel>
                                <p:inputMask id="dateDressage" value="#{saisieActeExistantBacking.acteNaissanceDto.dateDressage}"
                                            mask="99/99/9999 99:99:99" required="true">

                               </p:inputMask>
                                <p:watermark  value="jj/MM/AAAA HH:mm:ss" for="dateDressage"/>   
                                <p:message for="dateDressage"/>
                            </div>
                            <div class="p-field p-lg-4">
                                <p:outputLabel for="lienParenteDeclarant">Lien parenté déclarant</p:outputLabel>
                                <p:selectOneRadio id="lienParenteDeclarant" 
                                                  value="#{saisieActeExistantBacking.acteNaissanceDto.declarantLien}" 
                                                    converter="omnifaces.SelectItemsConverter"
                                                    required="true">

                                    <f:selectItems value="#{saisieActeExistantBacking.liensParenteDeclarant}" var="lien" 
                                                   itemLabel="#{lien.libelle}" itemValue="#{lien.code}"/>
                                    <p:ajax update="contentForm:declarantLienParente"/>
                                  </p:selectOneRadio>
                            </div>
                        </div>

                    </p:fieldset>
                    
                     <p:fieldset legend="Officier d'état civil">
                        <div class="ui-fluid p-formgrid p-grid">
                            <div class="p-field p-col">
                                <p:outputLabel for="officier" styleClass="p-d-block">Officier</p:outputLabel>
                                <p:selectOneMenu id="officier" value="#{saisieActeExistantBacking.acteNaissanceDto.officierEtatCivilID}"          
                                                 label="Selectionnez" required="true">
                                    <f:selectItem itemValue="#{null}" itemLabel="-- selectionnez un officier --" />
                                    <f:selectItems value="#{saisieActeExistantBacking.officiers}" var="officier" 
                                                   itemLabel="#{officier.prenoms} #{officier.nom} [#{officier.titre}]" 
                                                   itemValue="#{officier.id}"/>
                                </p:selectOneMenu>
                            </div>
                       </div>

                    </p:fieldset>
                </p:tab>
                <p:tab id="autresInformations" title="Autres Informations">
                    <ui:include src="/WEB-INF/includes/saisie-actes-existants/autres-informations.xhtml"/>     
                </p:tab>
                <p:tab id="mentions" title="Mentions">
                    <ui:include src="/WEB-INF/includes/saisie-actes-existants/mentions.xhtml"/> 
                    <ui:include src="/WEB-INF/includes/saisie-actes-existants/commands.xhtml"/>
                </p:tab>
            </p:wizard>
            
        </h:form>
          
        
    </ui:define>

</ui:composition>  
 
</html>

